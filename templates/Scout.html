{% extends "base.html" %}
{% block title %}Scout{% endblock %}
{% block content %}
<link rel="stylesheet" type="text/css" href="base.css">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    textarea{
        background-color: #d3af37;
        color: #012265;
    }
    hr{
        border: none;
        border-top: 2px solid black;
    }
    body {
      text-align: center;
      background-color: #012265;
    }
    p, h2, button, input, label, h6  {
        color: #d3af37;
    }
    input[id="submitButton"], input[type="submit"]{
        background-color: #d3af37;
        color: #012265;
        border: none;
    }
    input[name="scouter_name"], input[name="team"], input[name="qual_number"], select {
        background-color: #d3af37;
        color: #012265;
    }
    input[id="counter2"], input[id="counter1"], input[id="counter8"], input[id="counter9"],  input[id="counter7"] , input[id="counter3"], input[id="counter4"], input[id="counter5"], input[id="counter6"] {
        background-color: #012265;
        color: #d3af37;
        border: none;
    }

    .button-set {
        display: flex;
        align-items: center;
        justify-content: space-between;
        max-width: 150px;  /* Set the maximum width for the button set */
        margin: 0 auto;    /* Center the button set */
    }

    .button-set button, button {
        width: 100px;  /* Adjust the width of the +/- buttons */
        height: 30px;
        font-size: 16px;  /* Adjust the font size of the buttons */
        background-color: #d3af37;
        color: #012265;
        border: none;
    }

    .button-set input {
        width: 40px;  /* Adjust the width of the counter input */
        height: 30px;
        text-align: center;
        font-size: 16px;  /* Adjust the font size of the counter input */
    }

</style>

<head>
    <link rel="stylesheet" href="base.css">
    <title></title>
</head>

<form id="scoutForm" action="http://192.168.1.110:5000/process_form" method="post" onsubmit="return submitForm()">


    <p>Qual Number:</p>
    <label>
        <input type="text" name="qual_number">
    </label>

    <p>Team:</p>
    <label>
        <input type="text" name="team">
    </label>

    <p>Select Alliance:</p>
    <label for="alliance-select"></label>
    <select name="Alliances Options" id="alliance-select">
        <option value="">Please choose an alliance</option>
        <option value="Blue">Blue</option>
        <option value="Red">Red</option>
    </select>

    <script>
function updateCounter(change, counterId, category) {
    let counterValue = parseInt(document.getElementById(counterId).value);
    if ((counterId === 'counter7' && counterValue >= 3 && change > 0) ||
        (counterId === 'counter3' && counterValue >= 5 && change > 0) ||
        (counterId === 'counter8' && counterValue >= 3 && change > 0)) {
        return;
    }
    counterValue = Math.max(0, counterValue + change);
    document.getElementById(counterId).value = counterValue;
    let totalCounterId = 'totalCounter' + category;
    let totalCounterValue = parseInt(document.getElementById(totalCounterId).value);
    totalCounterValue = Math.max(0, totalCounterValue + change);
    document.getElementById(totalCounterId).value = totalCounterValue;
}
    </script>

    <br>
    <br>
    <hr>
    <h2>Autonomous</h2>

    <h6>AMP:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter1', 'Autonomous')">-</button>
        <label for="counter1"></label><input type="text" id="counter1" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter1', 'Autonomous')">+</button>
    </div>
        <br>
    <h6>Speaker:</h6>
    <div class="button-set">

        <button onclick="event.preventDefault(); updateCounter(-1, 'counter2', 'Autonomous')">-</button>
        <label for="counter2"></label><input type="text" id="counter2" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter2', 'Autonomous')">+</button>
    </div>
        <br>
    <div class="checkbox-container">
        <input type="checkbox" id="vehicle4" name="Another checkbox" value="Another checkbox">
        <label for="vehicle4">Left Robot Starting Zone</label>
    </div>
        <br>
    <div class="checkbox-container">
        <input type="checkbox" id="vehicle2" name="Another checkbox" value="Another checkbox">
        <label for="vehicle2">Arrived To the middle</label>
    </div>
        <br>

    <h6>Collected parts from the middle:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter3', 'Autonomous')">-</button>
        <label for="counter3"></label><input type="text" id="counter3" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter3', 'Autonomous')">+</button>
    </div>
        <br>
<hr>
    <h2>Teleop</h2>

    <h6>AMP:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter4', 'Teleop')">-</button>
        <label for="counter4"></label><input type="text" id="counter4" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter4', 'Teleop')">+</button>
    </div>
    <br>

    <h6>Speaker:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter5', 'Teleop')">-</button>
        <label for="counter5"></label><input type="text" id="counter5" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter5', 'Teleop')">+</button>
    </div>
    <br>
    <h6>Pins:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter6', 'Teleop')">-</button>
        <label for="counter6"></label><input type="text" id="counter6" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter6', 'Teleop')">+</button>
        </div>
            <br>
<hr>
    <h2>EndGame</h2>
    <title>Timer Climb</title>
          <style>
            #timerDisplay {
              font-size: 24px;
              margin-top: 10px;
            }
          </style>
      <style>
        #timerDisplay {
          font-size: 17px;
          margin-top: 10px;
        }
      </style>
        <h6>Climb timer:</h6>
    <button id="timerButton" onclick="toggleTimer()">Start Timer</button>
    <p id="timerDisplay">Timer: 0.00 seconds</p>

    <script>
      let timer;
      let isTimerRunning = false;
      let milliseconds = 0;

      function toggleTimer() {
        if (isTimerRunning) {
          clearInterval(timer);
          document.getElementById('timerButton').innerText = 'Start Climb';
        } else {
          timer = setInterval(updateTimer, 10); // update every 10 milliseconds
          document.getElementById('timerButton').innerText = 'Stop Climb';
        }
        isTimerRunning = !isTimerRunning;
      }

      function updateTimer() {
        milliseconds += 10;
        const seconds = (milliseconds / 1000).toFixed(2);
        document.getElementById('timerDisplay').innerText = 'Timer: ' + seconds + ' seconds';
      }
    </script>


    <h6>Trap:</h6>
    <div class="button-set">
        <button onclick="event.preventDefault(); updateCounter(-1, 'counter8', 'EndGame')">-</button>
        <label for="counter8"></label><input type="text" id="counter8" value="0" readonly>
        <button onclick="event.preventDefault(); updateCounter(1, 'counter8', 'EndGame')">+</button>
    </div>
        <br>


    <div class="checkbox-container">
        <label for="vehicle6"></label><input type="checkbox" id="vehicle6" name="Another checkbox" value="Another checkbox">
        <label for="vehicle2">Climbed with another robot</label>
    </div>

<script>
    var scouter_name = "{{ session['username'] }}";
function submitForm() {
    event.preventDefault();
    const validTeams = [1574, 1576, 1577, 1580,
        1690, 1942, 2230, 2630,
        2679, 3065, 3083, 3211,
        3316, 3339, 4319, 4320,
        4338, 5135, 5654, 5715,
        5990, 6230, 6738, 6740,
        6741, 7067, 7177, 8175,
        9303, 9738, 9740, 9741];

   const data = {
        'scouter_name': scouter_name,
        'qual_number': document.querySelector('input[name="qual_number"]').value,
        'team': document.querySelector('input[name="team"]').value,
        'Alliances Options': document.querySelector('select[name="Alliances Options"]').value,
        'left_robot_starting_zone': document.getElementById('vehicle4').checked,
        'arrived_to_the_middle': document.getElementById('vehicle2').checked,
        'collected_parts_from_the_middle': document.getElementById('counter3').value,
        'Auto AMP': document.getElementById('counter1').value,
        'Auto Speaker': document.getElementById('counter2').value,
        'Teleop AMP': document.getElementById('counter4').value,
        'Teleop Speaker': document.getElementById('counter5').value,
        'EndGame AMP': document.getElementById('counter6').value,
        'EndGame Speaker': document.getElementById('counter7').value,
        'EndGame Trap': document.getElementById('counter8').value,
        'Leaving the area': document.getElementById('vehicle2').checked,
        'Click Cooperation': document.getElementById('vehicle3').checked,
        'Cooperation point': document.getElementById('vehicle4').checked,
        'Climb': document.getElementById('vehicle5').checked,
        'Climbed with another robot': document.getElementById('vehicle6').checked,
        'comments': document.querySelector('textarea[name="comments"]').value
    };


    const teamNumber = document.getElementsByName('team')[0].value;

    if (!validTeams.includes(parseInt(teamNumber))) {
            alert('The team number is not valid.');
            return false;
        }

    const jsonData = JSON.stringify(data);
    const xhr = new XMLHttpRequest();

    // Configure the request
    xhr.open('POST', '/Scout', true);
    xhr.setRequestHeader('Content-Type', 'application/json');


    xhr.onload = function () {
        if (xhr.status === 200) {
            alert('Data saved successfully');
        } else {
            console.error('An error occurred:', xhr.status, xhr.responseText);
            alert('An error occurred!');
        }
    };

    xhr.onerror = function () {
        console.error('An error occurred:', xhr.status, xhr.responseText);
        alert('An error occurred: ' + xhr.responseText);  // Display more details in the alert
    };

    xhr.send(jsonData);
}

</script>
    <form action="/Scout" method="post">
    <br>
    <p>Comments:</p>
    <textarea name="comments" rows="4" cols="50"></textarea>
    <br>
    <input type="submit" value="Submit">
</form>
<br>

<form action="/Scout" method="post">
            <br>
    <input type="submit" value="Submit">
</form>
            <br>
</form>

{% endblock %}
